{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "rad.io schema for data files",
  "$id": "http://rado1.com/radio/schemas/dataSchema.json",
  "definitions": {
    "common": {
      "$id": "common",
      "properties": {
        "description": {
          "description": "Textual description of element",
          "type": "string"
        },
        "meta": {
          "description": "List of key-value pairs",
          "type": "array"
        }
      }
    },
    "visibility": {
      "description": "Element visibility",
      "enum": [
        "private",
        "protected",
        "public"
      ]
    },
    "multiplicity": {
      "description": "Multiplicity of property",
      "anyOf": [
        {
          "type": "string"
        },
        {
          "enum": [
            "1..1",
            "0..1",
            "0..N",
            "1..N"
          ]
        }
      ]
    },
    "class": {
      "description": "Definition of a class",
      "type": "object",
      "properties": {
        "name": {},
        "super": {},
        "visibility": {},
        "is_abstract": {},
        "attributes": {},
        "description": {},
        "meta": {}
      },
      "required": [
        "name"
      ],
      "additionalProperties": false,
      "allOf": [
        {
          "properties": {
            "name": {
              "description": "Name of class",
              "type": "string"
            },
            "super": {
              "description": "Superclass",
              "$ref": "#/definitions/class"
            },
            "visibility": {
              "$ref": "#/definitions/visibility"
            },
            "is_abstract": {
              "description": "Is class abstract?",
              "type": "boolean"
            },
            "attributes": {
              "description": "List of class attributes",
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": {},
                  "type": {},
                  "default": {},
                  "multiplicity": {},
                  "visibility": {},
                  "description": {},
                  "meta": {}
                },
                "required": [
                  "name",
                  "type"
                ],
                "additionalProperties": false,
                "allOf": [
                  {
                    "properties": {
                      "name": {
                        "description": "Name of attribute",
                        "type": "string"
                      },
                      "type": {
                        "description": "Type of attribute",
                        "type": "string"
                      },
                      "default": {
                        "description": "Default value",
                        "type": "string",
                        "examples": [ "!code" ]
                      },
                      "multiplicity": {
                        "$ref": "#/definitions/multiplicity"
                      },
                      "visibility": {
                        "$ref": "#/definitions/visibility"
                      }
                    }
                  },
                  {
                    "$ref": "#/definitions/common"
                  }
                ]              }
            }
          }
        },
        {
          "$ref": "#/definitions/common"
        }
      ]
    },
    "association": {
      "description": "Association of classes",
      "type": "object",
      "properties": {
        "from": {},
        "from_mult": {},
        "from_composition": {},
        "to": {},
        "to_mult": {},
        "to_composition": {},
        "description": {},
        "meta": {}
      },
      "required": [
        "from",
        "to"
      ],
      "additionalProperties": false,
      "allOf": [
        {
          "properties": {
            "from": {
              "description": "From class",
              "$ref": "#/definitions/class"
            },
            "from_mult": {
              "$ref": "#/definitions/multiplicity"
            },
            "from_composition": {
              "description": "Is from end composition?",
              "type": "boolean"
            },
            "to": {
              "description": "To class",
              "$ref": "#/definitions/class"
            },
            "to_mult": {
              "$ref": "#/definitions/multiplicity"
            },
            "to_composition": {
              "description": "Is to end composition?",
              "type": "boolean"
            }
          }
        },
        {
          "$ref": "#/definitions/common"
        }
      ]
    }
  },
  "type": "array",
  "items": {
    "type": "object",
    "properties": {
      "class": {
        "$ref": "#/definitions/class"
      },
      "association": {
        "$ref": "#/definitions/association"
      }
    },
    "additionalProperties": false,
    "maxProperties": 1
  }
}